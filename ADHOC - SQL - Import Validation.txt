DECLARE @OLDOB INT
SELECT @OLDOB = COUNT(*) FROM base.COMMISSIONS_OB

DECLARE @NEWOB INT
SELECT @NEWOB = COUNT(*) FROM dbo.ORDERBOOK

IF @NEWOB < @OLDOB GOTO EndScript

DELETE FROM base.COMMISSIONS_OB
INSERT INTO base.COMMISSIONS_OB
SELECT * FROM dbo.ORDERBOOK

DROP TABLE dbo.ORDERBOOK


EndScript:
PRINT 'NEW OB = ' + CAST(@NEWOB as NVARCHAR(MAX)) + ' OLD OB = ' + CAST(@OLDOB as NVARCHAR(MAX))